<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.saeipman.app.building.mapper.BuildingMapper">
	<select id="buildingList" resultType="BuildingVO">
		select *
		from (   select rownum rn ,
				 a.*        
		         from (SELECT building_id,
		                      building_name,
		                      doro_addr,
		                      details_addr,
		                      total_gagu
		                from  building_info
		                where IMDAEIN_ID = '10'
						order by 1
		 	)a
		<![CDATA[     
		where rownum <= #{pageNum} * #{amount} )b   
		
		where rn > (#{pageNum} -1) * #{amount}
		]]>
	</select>
	<select id="buildingListInfo" resultType="BuildingVO">
		SELECT building_id,
			   group_id,
			   building_name,
			   doro_addr,
			   jibun_addr,
			   details_addr,
			   gunchook_area,
			   total_floor,
			   floor_gagu_count,
			   total_gagu,
			   parking,
			   lift_yn,
			   delay_alert_yn,
			   minwon_alert_yn,
			   group_id
		FROM building_info 
		WHERE building_id = #{buildingId}
	</select>
	<insert id="buildingInsert" parameterType="BuildingVO">
		INSERT INTO building_info ( building_id,
									ocr_file_name,
									group_id,
									imdaein_id,
									building_name,
									doro_addr,
									details_addr,
									floor_area,
									floor_area_ratio,
									gunchook_area,
									building_heigh,
									lift_yn,
									total_floor,
									floor_gagu_count,
									total_gagu,
									parking,
									memo
								  )
		VALUES ('ZIP'||(LPAD(buildingSeq.nextval,6,'0')),
				#{ocrFileName},
				#{groupId},
				#{imdaeinId},
				#{buildingName},
				#{doroAddr},
				#{detailsAddr},
				#{floorArea},
				#{floorAreaRatio},
				#{gunchookArea},
				#{buildingHeigh},
				#{liftYn},
				#{totalFloor},
				#{floorGaguCount},
				#{totalGagu},
				#{parking},
				#{memo}
				)
	</insert>
	<update id="buildingUpdate" parameterType="BuildingVO" >
		UPDATE building_info
		SET delay_alert_yn = #{delayAlertYn},
			minwon_alert_yn = #{minwonAlertYn},
			building_name = #{buildingName},
			doro_addr = #{doroAddr},
			details_addr = #{detailsAddr},
			gunchook_area = #{gunchookArea},
			lift_yn = #{liftYn},
			total_floor = #{totalFloor},
			floor_gagu_count = #{floorGaguCount},
			total_gagu = #{totalGagu},
			parking = #{parking},
			memo = #{memo}
		WHERE building_id = #{buildingId}
		
	</update>
	<delete id="selectBuildingDelete" parameterType="String">
		Delete FROM building_info
		WHERE building_id =#{buildingId}
	</delete>
	
	<select id="getTotalPageCount" resultType="int">
		SELECT count(*)
		FROM building_info
		WHERE imdaein_id = '10'
	</select>
	
	<insert id = "selectRoomInsert" parameterType="RoomVO">
		insert into room_info(room_id,
                      room_no,
                      floor,
                      building_id)
		values (#{buildingId}||#{roomNo},
				#{roomNo},
				#{floor},
				#{buildingId}
				)
	</insert>
</mapper>
