<div xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layouts/default_layout}"
	layout:fragment="Main">
	<th:block th:replace="~{common/configs/default_config :: jQueryConfig}"></th:block>

	<div class="container-fluid pt-4 px-4">
		<div class="row g-4">
			<div class="col-sm-12 col-xl-12">
				<div class="bg-light rounded h-100 p-4">
					<form th:object="${BNotice}" name="UpdateForm">
						<h6 class="mb-4">공지사항 수정</h6>
						
						<div class="form-floating mb-3">
							<input type="text" class="form-control" id="floatingInput"
								placeholder="글번호" th:field="*{postNo}" readonly/> <label
								for="floatingInput">글번호</label>
						</div>
						
						<div class="form-floating mb-3">
							<input type="text" class="form-control" id="floatingInput"
								placeholder="제목" th:field="*{title}" /> <label
								for="floatingInput">제목</label>
						</div>
						<div class="form-floating mb-3">
							<select class="form-select" id="floatingSelect"
								aria-label="Floating label select example">
								<option selected>건물 목록</option>
								<option value="1">한입만 원룸</option>
								<option value="2">두입만 투룸</option>
								<option value="3">세입만 빌딩</option>
							</select> <label for="floatingSelect">공지사항을 등록할
								건물을 선택하세요.</label>
						</div>
						
						<div class="mb-3">
							<label for="formFileMultiple" class="form-label"></label> <input
								class="form-control" type="file" id="formFileMultiple" multiple
								th:field="*{groupId}" />
						</div>
						
						<div class="form-floating">
							<textarea class="form-control" placeholder="Leave a comment here"
								id="floatingTextarea" style="resize: none; height: 400px"
								th:field="*{content}"></textarea>
							<label for="floatingTextarea">내용</label>
						</div>
						<div class="form-floating mb-3"></div>
					</form>
				</div>
			</div>
		</div>
		<button style="text-align: center" type="button" id="updateBtn"
			class="btn btn-outline-success m-2">
			저장</button>
	</div>
</div>
<script>
  function getNoticeInfo() {
    let formData = $('form[name="UpdateForm"]').serializeArray();
    let noticeObj = {};
    $.each(formData, function (idx, keyVal) {
      noticeObj[keyVal.name] = keyVal.value;
    });
    console.log(noticeObj);
    return noticeObj;
  }

  $("#updateBtn").on("click", updateAjax);
  function updateAjax() {
    let info = getNoticeInfo();
    $.ajax(ctxPath + "/noticeBuildingUpdate", {
      type: "post",
      contentType: "application/json",
      data: JSON.stringify(info),
    })
      .done((result) => {
    	  alert('성공');
    	  location.href = ctxPath + "/noticeBuildingList";
      })
      .fail(err => alert("오류가 발생했습니다!"));
    }
      
      	
</script>
