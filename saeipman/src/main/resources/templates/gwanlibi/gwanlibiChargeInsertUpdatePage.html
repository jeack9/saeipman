<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{common/layouts/default_layout}"
	  layout:fragment="Main">

<head>
	<meta charset="UTF-8">

	<style>
		#bName {
			float: left;
			color: #000000;
			font-size: 20px;
			font-weight: bold;
		}
		
		#paymentMonth {
			float: right;
			color: #000000;
			font-size: 20px;
			font-weight: bold;
		}	
		
		.table {
			margin-left: auto;
			margin-right: auto;
		}

		.table td, .table th {
			text-align: center;
			border-collapse: collapse;
			border: 0px solid black;
			color: black;
		}
		
		.btnDiv {
			text-align: center;
		}
				
		.insertBtn, .updateBtn {
			display: inline-block;
			background: #6CBEC7;
			color: rgb(56, 53, 53);
		}

		
	</style>

</head>

<body>
	<div>
		<br>
		<br>

		<!-- 건물명 -->
<!-- 		<p id="bName"></p>
		
		<p id="paymentMonth"></p> -->

		<br>
		<br>

		<!-- Toast UI - Grid -->
		<div id="grid" style="position: relative; z-index: 1;"></div>

		<br>
		
		<div class="btnDiv">
			<button class="btn btn-light insertBtn">등록</button>
			<button class="btn btn-light updateBtn" th:onclick="|location.href='#'|">수정</button>
		</div>
		
		<br>
	</div>

	<script th:inline="javascript">

		// JavaScript에서 Thymeleaf 변수 사용하기 //
		/* 1. <script th:inline="javascript">
		   2. Thymeleaf 변수 사용 */
		let list = [[${ list }]];
		console.log(list);

		// 건물명 출력
		//$('#bName').text(list[0].buildingName);
		
		// 등록/수정할 월 출력.
/* 		console.log(list[0].paymentMonth);
		let date = new Date(new Date(list[0].paymentMonth));
		let splitDate = date.toISOString().split('T')[0].split('-');		
		let resultDate = splitDate[0] + '년 ' + splitDate[1] + '월';
		$('#paymentMonth').text(resultDate); */
		
		// TOAST UI //
		// async - await
		let grid;
		$(document).ready(() => {
			grid = gridLoad();
		});

		// 등록 버튼 클릭 이벤트
		$('.insertBtn').on('click', function() {
			$.ajax({
				type: 'post',
				url:  `/insertMaintenceCost`,
				contentType: 'application/json',				
				data: JSON.stringify(grid.getData()),
				success: function(data){
					console.log("suceess");
					
				},
				error: function(err){
					console.log(err);
				}
			})
		})

		
		// Toast UI - Grid //
		// # reference : https://adjh54.tistory.com/95
		// # reference : https://park-duck.tistory.com/entry/javascript-1-Toast-UI-Grid-%EA%B8%B0%EC%B4%88API-%EC%82%AC%EC%9A%A9%EB%B2%95
		// 01. Grid 생성.
		// return void
		const gridLoad = () => {
			const Grid = tui.Grid;
			// 02. Grid theme 설정. (clean, stripe, default)
			Grid.applyTheme('stripe');

			// 03. Toast UI Grid 구성.
			const grid = new Grid({
				// ================================== 공통 옵션 적용 ================================== //
				el: document.getElementById('grid'), // 필수 : Container element
				data: list,
				scrollX: false,
				scrollY: false,
				// ================================== 컬럼 옵션 적용 ================================== //
				columns: [
					// [Column-1] 관리비 항목 명
					{
						header: '관리비 항목 명',           // [필수] 컬럼 이름
						name: 'gwanlibiName',           // [필수] 컬럼 매핑 이름 값
						resizable: true,                // [선택] 컬럼의 리사이즈 여부 옵션
						align: 'center'
					},
					// [Column-2] 관리 비용
					{
						header: '관리 비용',
						name: 'gwanlibiItemMoney',
						resizable: true,
						align: 'center',
						editor: 'text',
						validation: {
							dataType: 'number'
						}
					}
				]
			})
			grid.validate();
			return grid;

		}

	</script>

</body>

</html>