<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{common/layouts/default_layout}"
	  layout:fragment="Main">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<form  name="updateForm" th:object="${minwon}">
	<input name="postNo" th:value="${minwon.postNo}" type="hidden">
		<div class="mb-3">
			<label for="">제목</label>
			<input class="form-control" type="text" th:field="*{title}">
		</div>
		<div class="mb-3">
			<label for="roomNo">작성자</label>
			<input class="form-control" type="text" th:field="*{roomNo}" readonly/>
		</div>
		
		<div class="mb-3">
		<label for="category">카테고리</label>
		<select class="form-select" th:field="*{category}" >
			 <option value="" selected >카테고리를 선택하세요</option>
			 	<option th:each="category : ${categories}"
                    	th:text="${category.categoryType}" th:value="${category.categoryNo}">
             	</option>
		</select>
		</div>
		
		<div class="mb-3">
		    <label for="visitsDate">방문날짜</label>
		    <input type="datetime-local" class="form-control" name="visitsDate1" th:value="${#temporals.format(minwon.visitsDate1, 'yyyy-MM-dd HH:mm')}">
		</div>
		
		
		<div class="mb-3">
		    <label for="visitsDate">방문날짜(택2)</label>
		    <input type="datetime-local" class="form-control" name="visitsDate2" th:value="${#temporals.format(minwon.visitsDate2, 'yyyy-MM-dd HH:mm')}">
		</div>
		

		<div class="file-input">
			 <label for="formFile" class="form-label">첨부파일</label>
			 <input class="form-control" type="file" name="file" th:field="*{fileName}">
		</div>
		<div class="mb-3">
  			<label for="content" class="form-label">내용</label>
  			<textarea class="form-control" id="exampleFormControlTextarea1" rows="3" th:field="*{content}"></textarea>
		</div>
		<div>
			<button type="button" id="updateBtn" class="btn btn-outline-warning m-2">수정</button>
		</div>
	</form>
	<script>
		$('#updateBtn').on('click', update);
		
		function update(e){
			let fromData = new FormData();
			let inputFile = $("input[name='file']");
			let files = inputFile[0].files;
			console.log(files)
			
			for(let i=0; i<files.length; i++){
				formData.append("file", files[i]);
			}
			
			
			$.ajax({
				url : '/minwonUpdate',
				type : 'POST',
				data : fromData,
				processData: false,
	            contentType: false,
	            success : function(result){
	            	alert("Uploaded")
	            }
			});
		}
		
	</script>
</body>
</html>